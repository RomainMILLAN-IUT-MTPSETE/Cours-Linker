(this.webpackJsonp=this.webpackJsonp||[]).push([[121],{"02hj":function(e,t,i){"use strict";var n=i("U1Ws");t.a={data:()=>({remainingTime:Object(n.u)(0),remainingTimeIntervalId:null}),mounted(){this.startRemainingTimeInterval()},beforeDestroy(){this.remainingTimeIntervalId&&clearInterval(this.remainingTimeIntervalId)},computed:{isDelayedJob(){var e,t;return(null===(e=this.job)||void 0===e?void 0:e.scheduled)||(null===(t=this.job)||void 0===t?void 0:t.scheduledAt)},scheduledTime(){return this.job.scheduled_at||this.job.scheduledAt}},watch:{isDelayedJob(){this.startRemainingTimeInterval()}},methods:{startRemainingTimeInterval(){var e=this;this.remainingTimeIntervalId&&clearInterval(this.remainingTimeIntervalId),this.isDelayedJob&&(this.updateRemainingTime(),this.remainingTimeIntervalId=setInterval((function(){return e.updateRemainingTime()}),1e3))},updateRemainingTime(){const e=Object(n.g)(this.scheduledTime);this.remainingTime=Object(n.u)(e)}}}},"15LA":function(e,t,i){"use strict";var n=i("SYh6");t.a=Object(n.a)()},Eycv:function(e,t,i){"use strict";var n={components:{CiIcon:i("Ng9o").a},props:{name:{type:String,required:!0},status:{type:Object,required:!0},iconSize:{type:Number,required:!1,default:16}}},s=i("bPvS"),a=Object(s.a)(n,(function(){var e=this._self._c;return e("span",{staticClass:"mw-100 gl-display-flex gl-align-items-center gl-flex-grow-1"},[e("ci-icon",{staticClass:"gl-line-height-0",attrs:{size:this.iconSize,status:this.status}}),this._v(" "),e("span",{staticClass:"gl-text-truncate mw-70p gl-pl-3 gl-display-inline-block"},[this._v("\n    "+this._s(this.name)+"\n  ")])],1)}),[],!1,null,null,null);t.a=a.exports},dGVp:function(e,t,i){"use strict";var n=i("H8gz"),s=i("cuRJ"),a=i("zLBL"),o=i("ly/8"),l=i("mNEC"),r=i("mphk"),d=i("/LsX"),p=i("vRHk"),c=i("t9l/"),u=i("DT29"),g={components:{GlIcon:n.a,GlButton:s.a,GlLoadingIcon:a.a},directives:{GlTooltip:o.a},props:{tooltipText:{type:String,required:!0},link:{type:String,required:!0},actionIcon:{type:String,required:!0},withConfirmationModal:{type:Boolean,required:!1,default:!1},shouldTriggerClick:{type:Boolean,required:!1,default:!1}},data:()=>({isDisabled:!1,isLoading:!1}),computed:{cssClass(){const e=Object(p.l)(this.actionIcon);return`${e} js-icon-${e}`}},watch:{shouldTriggerClick(e){e&&this.withConfirmationModal&&(this.executeAction(),this.$emit("actionButtonClicked"))}},errorCaptured(e,t,i){Object(u.f)("action_component",`error: ${e}, info: ${i}`)},methods:{onClickAction(){this.withConfirmationModal?this.$emit("showActionConfirmationModal"):this.executeAction()},executeAction(){var e=this;this.$root.$emit(d.d,"js-ci-action-"+this.link),this.isDisabled=!0,this.isLoading=!0,r.a.post(this.link+".json").then((function(){e.isLoading=!1,e.$emit("pipelineActionRequestComplete")})).catch((function(t){e.isDisabled=!1,e.isLoading=!1,Object(u.f)("action_component",t),Object(l.createAlert)({message:Object(c.a)("An error occurred while making the request.")})}))}}},m=i("bPvS"),h=Object(m.a)(g,(function(){var e=this,t=e._self._c;return t("gl-button",{ref:"button",staticClass:"js-ci-action gl-ci-action-icon-container ci-action-icon-container ci-action-icon-wrapper gl-display-flex gl-align-items-center gl-justify-content-center",class:e.cssClass,attrs:{id:"js-ci-action-"+e.link,disabled:e.isDisabled,"data-testid":"ci-action-component"},on:{click:function(t){return t.stopPropagation(),e.onClickAction.apply(null,arguments)}}},[t("div",{directives:[{name:"gl-tooltip",rawName:"v-gl-tooltip.viewport",modifiers:{viewport:!0}}],staticClass:"gl-display-flex gl-align-items-center gl-justify-content-center gl-h-full",attrs:{title:e.tooltipText,"data-testid":"ci-action-icon-tooltip-wrapper"}},[e.isLoading?t("gl-loading-icon",{staticClass:"js-action-icon-loading",attrs:{size:"sm"}}):t("gl-icon",{staticClass:"gl-mr-0!",attrs:{name:e.actionIcon,"aria-label":e.actionIcon}})],1)])}),[],!1,null,null,null);t.a=h.exports},mcq9:function(e,t,i){"use strict";var n=i("H8gz"),s=i("zLBL"),a=i("OkMp"),o=i("ly/8"),l=i("Ng9o"),r=i("mNEC"),d=i("mphk"),p=i("t9l/"),c=i("15LA"),u=i("u1ru"),g=i("02hj"),m=i("/LsX"),h=i("DT29"),b=i("dGVp"),v=i("Eycv"),w={i18n:{runAgainTooltipText:Object(p.a)("Run again")},hoverClass:"gl-shadow-x0-y0-b3-s1-blue-500",components:{ActionComponent:b.a,JobNameComponent:v.a,GlLink:u.a},directives:{GlTooltip:o.a},mixins:[g.a],props:{job:{type:Object,required:!0},cssClassJobName:{type:String,required:!1,default:""},dropdownLength:{type:Number,required:!1,default:1/0},jobHovered:{type:String,required:!1,default:""},pipelineExpanded:{type:Object,required:!1,default:function(){return{}}},pipelineId:{type:Number,required:!1,default:-1}},computed:{boundary(){return 1===this.dropdownLength?"viewport":"scrollParent"},detailsPath(){return this.status.details_path},hasDetails(){return this.status.has_details},status(){return this.job&&this.job.status?this.job.status:{}},tooltipText(){const e=[],{name:t}=this.job;t&&e.push(t);const{tooltip:i}=this.status;return t&&i&&e.push("-"),i&&(this.isDelayedJob?e.push(Object(p.h)(i,{remainingTime:this.remainingTime})):e.push(i)),e.join(" ")},hasAction(){return this.job.status&&this.job.status.action&&this.job.status.action.path},relatedDownstreamHovered(){return this.job.name===this.jobHovered},relatedDownstreamExpanded(){return this.job.name===this.pipelineExpanded.jobName&&this.pipelineExpanded.expanded},jobClasses(){return this.relatedDownstreamHovered||this.relatedDownstreamExpanded?`${this.$options.hoverClass} ${this.cssClassJobName}`:this.cssClassJobName},jobActionTooltipText(){const{group:e}=this.status,{title:t,icon:i}=this.status.action;return"retry"===i&&"success"===e?this.$options.i18n.runAgainTooltipText:t}},errorCaptured(e,t,i){Object(h.f)("pipelines_job_item",`pipelines_job_item error: ${e}, info: ${i}`)},methods:{hideTooltips(){this.$root.$emit(m.d)}}},f=i("bPvS"),y=Object(f.a)(w,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"ci-job-component gl-display-flex gl-align-items-center gl-justify-content-space-between",attrs:{"data-qa-selector":"job_item_container"}},[e.hasDetails?t("gl-link",{directives:[{name:"gl-tooltip",rawName:"v-gl-tooltip",value:{boundary:"viewport",placement:"bottom",customClass:"gl-pointer-events-none"},expression:"{\n      boundary: 'viewport',\n      placement: 'bottom',\n      customClass: 'gl-pointer-events-none',\n    }"}],staticClass:"js-pipeline-graph-job-link menu-item gl-text-gray-900 gl-active-text-decoration-none gl-focus-text-decoration-none gl-hover-text-decoration-none",class:e.jobClasses,attrs:{href:e.detailsPath,title:e.tooltipText,"data-testid":"job-with-link"},on:{click:function(t){return t.stopPropagation(),e.hideTooltips.apply(null,arguments)},mouseout:e.hideTooltips}},[t("job-name-component",{attrs:{name:e.job.name,status:e.job.status}})],1):t("div",{directives:[{name:"gl-tooltip",rawName:"v-gl-tooltip",value:{boundary:e.boundary,placement:"bottom",customClass:"gl-pointer-events-none"},expression:"{ boundary, placement: 'bottom', customClass: 'gl-pointer-events-none' }"}],staticClass:"js-job-component-tooltip non-details-job-component menu-item",class:e.jobClasses,attrs:{title:e.tooltipText,"data-testid":"job-without-link"},on:{mouseout:e.hideTooltips}},[t("job-name-component",{attrs:{name:e.job.name,status:e.job.status}})],1),e._v(" "),e.hasAction?t("action-component",{attrs:{"tooltip-text":e.jobActionTooltipText,link:e.status.action.path,"action-icon":e.status.action.icon,"data-qa-selector":"action_button"}}):e._e()],1)}),[],!1,null,null,null).exports,j={i18n:{stage:Object(p.a)("Stage:"),loadingText:Object(p.a)("Loading, please wait.")},dropdownPopperOpts:{placement:"bottom",positionFixed:!0},components:{CiIcon:l.a,GlLoadingIcon:s.a,GlDropdown:a.a,JobItem:y},directives:{GlTooltip:o.a},props:{stage:{type:Object,required:!0},updateDropdown:{type:Boolean,required:!1,default:!1},isMergeTrain:{type:Boolean,required:!1,default:!1}},data:()=>({isDropdownOpen:!1,isLoading:!1,dropdownContent:[],stageName:""}),watch:{updateDropdown(){this.updateDropdown&&this.isDropdownOpen&&!this.isLoading&&this.fetchJobs()}},methods:{onHideDropdown(){this.isDropdownOpen=!1},onShowDropdown(){c.a.$emit("clickedDropdown"),this.isDropdownOpen=!0,this.isLoading=!0,this.fetchJobs(),this.$emit("miniGraphStageClick")},fetchJobs(){var e=this;d.a.get(this.stage.dropdown_path).then((function({data:t}){e.dropdownContent=t.latest_statuses,e.stageName=t.name,e.isLoading=!1})).catch((function(){e.$refs.dropdown.hide(),e.isLoading=!1,Object(r.createAlert)({message:Object(p.a)("Something went wrong on our end.")})}))},stageAriaLabel:e=>Object(p.h)(Object(p.a)("View Stage: %{title}"),{title:e})}},C={components:{PipelineStage:Object(f.a)(j,(function(){var e=this,t=e._self._c;return t("gl-dropdown",{directives:[{name:"gl-tooltip",rawName:"v-gl-tooltip.hover.ds0",modifiers:{hover:!0,ds0:!0}},{name:"gl-tooltip",rawName:"v-gl-tooltip",value:e.stage.title,expression:"stage.title"}],ref:"dropdown",attrs:{"data-testid":"mini-pipeline-graph-dropdown",variant:"link","aria-label":e.stageAriaLabel(e.stage.title),lazy:!0,"popper-opts":e.$options.dropdownPopperOpts,"toggle-class":["gl-rounded-full!"],"menu-class":"mini-pipeline-graph-dropdown-menu"},on:{hide:e.onHideDropdown,show:e.onShowDropdown},scopedSlots:e._u([{key:"button-content",fn:function(){return[t("ci-icon",{staticClass:"gl-display-inline-flex gl-align-items-center gl-border gl-z-index-1",attrs:{"is-borderless":"","is-interactive":"","css-classes":"gl-rounded-full","is-active":e.isDropdownOpen,size:24,status:e.stage.status}})]},proxy:!0}])},[e._v(" "),e.isLoading?t("div",{staticClass:"gl--flex-center gl-p-2",attrs:{"data-testid":"pipeline-stage-loading-state"}},[t("gl-loading-icon",{staticClass:"gl-mr-3",attrs:{size:"sm"}}),e._v(" "),t("p",{staticClass:"gl-line-height-normal gl-mb-0"},[e._v(e._s(e.$options.i18n.loadingText))])],1):t("ul",{staticClass:"js-builds-dropdown-list scrollable-menu",attrs:{"data-testid":"mini-pipeline-graph-dropdown-menu-list"}},[t("div",{staticClass:"gl--flex-center gl-border-b gl-font-weight-bold gl-mb-3 gl-pb-3"},[t("span",{staticClass:"gl-mr-1"},[e._v(e._s(e.$options.i18n.stage))]),e._v(" "),t("span",{attrs:{"data-testid":"pipeline-stage-dropdown-menu-title"}},[e._v(e._s(e.stageName))])]),e._v(" "),e._l(e.dropdownContent,(function(i){return t("li",{key:i.id},[t("job-item",{attrs:{"dropdown-length":e.dropdownContent.length,job:i,"css-class-job-name":"mini-pipeline-graph-dropdown-item"}})],1)})),e._v(" "),e.isMergeTrain?[t("li",{staticClass:"gl-dropdown-divider",attrs:{role:"presentation"}},[t("hr",{staticClass:"dropdown-divider",attrs:{role:"separator","aria-orientation":"horizontal"}})]),e._v(" "),t("li",[t("div",{staticClass:"gl-display-flex gl-align-items-center",attrs:{"data-testid":"warning-message-merge-trains"}},[t("div",{staticClass:"menu-item gl-font-sm gl-text-gray-300!"},[e._v("\n            "+e._s(e.s__("Pipeline|Merge train pipeline jobs can not be retried"))+"\n          ")])])])]:e._e()],2)])}),[],!1,null,null,null).exports},props:{stages:{type:Array,required:!0},updateDropdown:{type:Boolean,required:!1,default:!1},isMergeTrain:{type:Boolean,required:!1,default:!1}}},x=Object(f.a)(C,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"gl-display-inline gl-vertical-align-middle",attrs:{"data-testid":"pipeline-stages"}},e._l(e.stages,(function(i){return t("div",{key:i.name,staticClass:"pipeline-mini-graph-stage-container dropdown gl-display-inline-block gl-mr-2 gl-my-2 gl-vertical-align-middle"},[t("pipeline-stage",{attrs:{stage:i,"update-dropdown":e.updateDropdown,"is-merge-train":e.isMergeTrain},on:{miniGraphStageClick:function(t){return e.$emit("miniGraphStageClick")}}})],1)})),0)}),[],!1,null,null,null).exports,T=i("k6qc"),_=i.n(T);const k={rest:{detailedStatus:["details","status"]},graphql:{detailedStatus:"detailedStatus"}},P=function(e,t,i){return _()(e,k[t][i])};var D={directives:{GlTooltip:o.a},components:{CiIcon:l.a},inject:{dataMethod:{default:"rest"}},props:{triggeredBy:{type:Array,required:!1,default:function(){return[]}},triggered:{type:Array,required:!1,default:function(){return[]}},pipelinePath:{type:String,required:!1,default:""}},data:()=>({maxRenderedPipelines:3}),computed:{isUpstream(){return Boolean(this.triggeredBy.length)&&!this.triggered.length},isDownstream(){return!this.triggeredBy.length&&Boolean(this.triggered.length)},linkedPipelines(){return this.isUpstream?this.triggeredBy:this.triggered},totalPipelineCount(){return this.linkedPipelines.length},linkedPipelinesTrimmed(){return this.totalPipelineCount>this.maxRenderedPipelines?this.linkedPipelines.slice(0,this.maxRenderedPipelines):this.linkedPipelines},shouldRenderCounter(){return this.isDownstream&&this.linkedPipelines.length>this.maxRenderedPipelines},counterLabel(){return"+"+(this.linkedPipelines.length-this.maxRenderedPipelines)},counterTooltipText(){return Object(p.h)(Object(p.g)("LinkedPipelines|%{counterLabel} more downstream pipelines"),{counterLabel:this.counterLabel})}},methods:{pipelineTooltipText(e){const{label:t}=P(e,this.dataMethod,"detailedStatus");return`${e.project.name} - ${t}`},pipelineStatus(e){var t;return(null==e?void 0:e.detailedStatus)||(null==e||null===(t=e.details)||void 0===t?void 0:t.status)},triggerButtonClass(e){const{group:t}=P(e,this.dataMethod,"detailedStatus");return"ci-status-icon-"+t}}},O=Object(f.a)(D,(function(){var e=this,t=e._self._c;return e.linkedPipelines?t("span",{staticClass:"linked-pipeline-mini-list gl-display-inline gl-vertical-align-middle",class:{"is-upstream":e.isUpstream,"is-downstream":e.isDownstream}},[e._l(e.linkedPipelinesTrimmed,(function(i){return t("a",{directives:[{name:"gl-tooltip",rawName:"v-gl-tooltip",value:{title:e.pipelineTooltipText(i)},expression:"{ title: pipelineTooltipText(pipeline) }"}],key:i.id,staticClass:"linked-pipeline-mini-item gl-display-inline-block gl-h-6 gl-mr-2 gl-my-2 gl-rounded-full gl-vertical-align-middle",class:e.triggerButtonClass(i),attrs:{href:i.path,"data-testid":"linked-pipeline-mini-item"}},[t("ci-icon",{staticClass:"gl-align-items-center gl-border gl-display-inline-flex",attrs:{"is-borderless":"","is-interactive":"","css-classes":"gl-rounded-full",size:24,status:e.pipelineStatus(i)}})],1)})),e._v(" "),e.shouldRenderCounter?t("a",{directives:[{name:"gl-tooltip",rawName:"v-gl-tooltip",value:{title:e.counterTooltipText},expression:"{ title: counterTooltipText }"}],staticClass:"gl-align-items-center gl-bg-gray-50 gl-display-inline-flex gl-font-sm gl-h-6 gl-justify-content-center gl-rounded-pill gl-text-decoration-none gl-text-gray-500 gl-w-7 linked-pipelines-counter linked-pipeline-mini-item",attrs:{title:e.counterTooltipText,href:e.pipelinePath,"data-testid":"linked-pipeline-counter"}},[e._v("\n    "+e._s(e.counterLabel)+"\n  ")]):e._e()],2):e._e()}),[],!1,null,null,null).exports,S={components:{GlIcon:n.a,LinkedPipelinesMiniList:O,PipelineStages:x},arrowStyles:["arrow-icon gl-display-inline-block gl-mx-1 gl-text-gray-500 gl-vertical-align-middle!"],props:{downstreamPipelines:{type:Array,required:!1,default:function(){return[]}},isMergeTrain:{type:Boolean,required:!1,default:!1},pipelinePath:{type:String,required:!1,default:""},stages:{type:Array,required:!0,default:function(){return[]}},updateDropdown:{type:Boolean,required:!1,default:!1},upstreamPipeline:{type:Object,required:!1,default:function(){}}},computed:{hasDownstreamPipelines(){return Boolean(this.downstreamPipelines.length)}}},q=Object(f.a)(S,(function(){var e=this,t=e._self._c;return t("div",{attrs:{"data-testid":"pipeline-mini-graph"}},[e.upstreamPipeline?t("linked-pipelines-mini-list",{attrs:{"triggered-by":[e.upstreamPipeline],"data-testid":"pipeline-mini-graph-upstream"}}):e._e(),e._v(" "),e.upstreamPipeline?t("gl-icon",{class:e.$options.arrowStyles,attrs:{name:"long-arrow","data-testid":"upstream-arrow-icon"}}):e._e(),e._v(" "),t("pipeline-stages",{attrs:{"is-merge-train":e.isMergeTrain,stages:e.stages,"update-dropdown":e.updateDropdown,"data-testid":"pipeline-stages"},on:{miniGraphStageClick:function(t){return e.$emit("miniGraphStageClick")}}}),e._v(" "),e.hasDownstreamPipelines?t("gl-icon",{class:e.$options.arrowStyles,attrs:{name:"long-arrow","data-testid":"downstream-arrow-icon"}}):e._e(),e._v(" "),e.hasDownstreamPipelines?t("linked-pipelines-mini-list",{attrs:{triggered:e.downstreamPipelines,"pipeline-path":e.pipelinePath,"data-testid":"pipeline-mini-graph-downstream"}}):e._e()],1)}),[],!1,null,null,null);t.a=q.exports}}]);
//# sourceMappingURL=121.c6904919.chunk.js.map